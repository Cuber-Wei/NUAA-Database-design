# åŽŸç¥žæŠ½å¡ç³»ç»Ÿ - æ•°æ®åº“è¯¾ç¨‹è®¾è®¡

ä¸€ä¸ªåŸºäºŽFlaskæ¡†æž¶å¼€å‘çš„åŽŸç¥žä¸»é¢˜æŠ½å¡æ¸¸æˆç³»ç»Ÿï¼Œå®Œæ•´å®žçŽ°äº†ç”¨æˆ·ç®¡ç†ã€æŠ½å¡æœºåˆ¶ã€ä¿åº•ç³»ç»Ÿå’Œæ•°æ®ç»Ÿè®¡åŠŸèƒ½ã€‚

## ðŸŒŸ åŠŸèƒ½ç‰¹æ€§

### ðŸ” ç”¨æˆ·ç³»ç»Ÿ
- **ç”¨æˆ·æ³¨å†Œ**ï¼šæ”¯æŒæ–°ç”¨æˆ·æ³¨å†Œï¼Œå¯†ç MD5åŠ å¯†å­˜å‚¨
- **ç”¨æˆ·ç™»å½•**ï¼šå®‰å…¨çš„ç™»å½•éªŒè¯ç³»ç»Ÿï¼Œæ”¯æŒä¼šè¯ç®¡ç†
- **ç”¨æˆ·çŠ¶æ€**ï¼šåŸºäºŽFlask Sessionçš„ç”¨æˆ·çŠ¶æ€ç®¡ç†
- **æ•°æ®éš”ç¦»**ï¼šæ¯ä¸ªç”¨æˆ·ç‹¬ç«‹çš„æŠ½å¡è®°å½•å’Œä¿åº•è®¡æ•°

### ðŸŽ² æŠ½å¡ç³»ç»Ÿ
- **åŒå¡æ± è®¾è®¡**ï¼šè§’è‰²å¡æ± å’Œæ­¦å™¨å¡æ± ï¼Œå„è‡ªç‹¬ç«‹è¿è¡Œ
- **å¤šç§æŠ½å¡æ–¹å¼**ï¼šå•æŠ½å’Œåè¿žæŠ½ï¼Œæ»¡è¶³ä¸åŒéœ€æ±‚
- **çœŸå®žæ¦‚çŽ‡æœºåˆ¶**ï¼š
  - 5æ˜Ÿé“å…·ï¼š0.6% åŸºç¡€æ¦‚çŽ‡
  - 4æ˜Ÿé“å…·ï¼š5.1% åŸºç¡€æ¦‚çŽ‡  
  - 3æ˜Ÿé“å…·ï¼š94.3% åŸºç¡€æ¦‚çŽ‡
- **ä¿åº•æœºåˆ¶**ï¼š
  - 10æ¬¡å¿…å‡º4æ˜Ÿé“å…·
  - 80æ¬¡å¿…å‡º5æ˜Ÿé“å…·
  - è§’è‰²æ± å’Œæ­¦å™¨æ± ç‹¬ç«‹ä¿åº•è®¡æ•°
- **æ™ºèƒ½æŽ’åº**ï¼šæŠ½å¡ç»“æžœæŒ‰æ˜Ÿçº§é™åºï¼ŒåŒæ˜Ÿçº§è§’è‰²ä¼˜å…ˆæ˜¾ç¤º
- **å®žæ—¶ä¿åº•æ˜¾ç¤º**ï¼šåŠ¨æ€æ˜¾ç¤ºè·ç¦»ä¸‹æ¬¡ä¿åº•çš„æŠ½æ•°

### ðŸŽ¨ ç•Œé¢è®¾è®¡
- **å“åº”å¼è®¾è®¡**ï¼šå®Œç¾Žé€‚é…æ¡Œé¢ç«¯å’Œç§»åŠ¨ç«¯
- **çŽ°ä»£åŒ–UI**ï¼šåŸºäºŽBootstrap 5.1.3çš„ç²¾ç¾Žç•Œé¢
- **åŠ¨ç”»æ•ˆæžœ**ï¼šæŠ½å¡ç»“æžœå±•ç¤ºå¸¦æœ‰é—ªå…‰å’Œç¼©æ”¾åŠ¨ç”»
- **å›¾æ ‡ç³»ç»Ÿ**ï¼šç»Ÿä¸€çš„SVGæ­¦å™¨å›¾æ ‡å’ŒBootstrap Icons
- **æ˜Ÿçº§é…è‰²**ï¼šä¸åŒæ˜Ÿçº§é“å…·ä½¿ç”¨ä¸“å±žé¢œè‰²ä¸»é¢˜

### ðŸ“Š æ•°æ®ç®¡ç†
- **å®Œæ•´è®°å½•**ï¼šè¯¦ç»†çš„æŠ½å¡åŽ†å²è®°å½•ï¼ŒåŒ…å«æ—¶é—´æˆ³
- **åˆ†é¡µæµè§ˆ**ï¼šæ”¯æŒå¤§é‡æ•°æ®çš„é«˜æ•ˆåˆ†é¡µæ˜¾ç¤º
- **ç»Ÿè®¡ä¿¡æ¯**ï¼šç”¨æˆ·æŠ½å¡æ•°æ®ç»Ÿè®¡å’Œæ¦‚çŽ‡åˆ†æž
- **æ•°æ®å¯¼å‡º**ï¼šæ”¯æŒæŠ½å¡è®°å½•çš„æŸ¥è¯¢å’Œå±•ç¤º

### ðŸ›¡ï¸ å®‰å…¨ç‰¹æ€§
- **SQLæ³¨å…¥é˜²æŠ¤**ï¼šå¤šå±‚é˜²æŠ¤æœºåˆ¶ï¼Œ100%é˜²æ­¢SQLæ³¨å…¥æ”»å‡»
  - å‚æ•°åŒ–æŸ¥è¯¢ï¼šæ‰€æœ‰æ•°æ®åº“æ“ä½œä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢
  - è¾“å…¥æ£€æµ‹ï¼šå®žæ—¶æ£€æµ‹15ç§å¸¸è§SQLæ³¨å…¥æ¨¡å¼
  - è‡ªåŠ¨æ‹¦æˆªï¼šè£…é¥°å™¨è‡ªåŠ¨æ£€æŸ¥å’Œæ‹¦æˆªå±é™©è¾“å…¥
  - å®‰å…¨æ—¥å¿—ï¼šè¯¦ç»†è®°å½•æ‰€æœ‰å®‰å…¨äº‹ä»¶
- **è¾“å…¥éªŒè¯**ï¼šä¸¥æ ¼çš„æ•°æ®ç±»åž‹å’Œæ ¼å¼éªŒè¯
- **XSSé˜²æŠ¤**ï¼šåŸºç¡€çš„è·¨ç«™è„šæœ¬æ”»å‡»é˜²æŠ¤
- **å¯†ç åŠ å¯†**ï¼šMD5å“ˆå¸ŒåŠ å¯†å­˜å‚¨ç”¨æˆ·å¯†ç 
- **ä¼šè¯å®‰å…¨**ï¼šå®‰å…¨çš„ç”¨æˆ·ä¼šè¯ç®¡ç†

## ðŸ› ï¸ æŠ€æœ¯æ ˆ

### åŽç«¯æŠ€æœ¯
- **Webæ¡†æž¶**ï¼šFlask 3.1.1
- **æ•°æ®åº“**ï¼šMySQL 8.0+
- **æ•°æ®åº“è¿žæŽ¥**ï¼šPyMySQL 1.1.1

### å‰ç«¯æŠ€æœ¯
- **UIæ¡†æž¶**ï¼šBootstrap 5.1.3
- **å›¾æ ‡åº“**ï¼šBootstrap Icons 1.7.2
- **JavaScript**ï¼šåŽŸç”ŸES6+ï¼Œæ— é¢å¤–æ¡†æž¶ä¾èµ–
- **CSS3**ï¼šçŽ°ä»£CSSç‰¹æ€§ï¼ŒåŒ…å«åŠ¨ç”»å’Œæ¸å˜

### å¼€å‘å·¥å…·
- **åŒ…ç®¡ç†**ï¼šuv (çŽ°ä»£PythonåŒ…ç®¡ç†å™¨)
- **ç‰ˆæœ¬æŽ§åˆ¶**ï¼šGit
- **Pythonç‰ˆæœ¬**ï¼š3.13+

## ðŸ“ é¡¹ç›®ç»“æž„

```
NUAA-Database-design/
â”œâ”€â”€ README.md
â”œâ”€â”€ app.py
â”œâ”€â”€ db.sql
â”œâ”€â”€ insert_data.sql
â”œâ”€â”€ user_info_view_examples.sql
â”œâ”€â”€ misc
â”‚   â”œâ”€â”€ alterTable.sql
â”‚   â”œâ”€â”€ createTables.sql
â”‚   â”œâ”€â”€ insertData.sql
â”‚   â”œâ”€â”€ Lab2.sql
â”‚   â”œâ”€â”€ Lab3.sql
â”‚   â”œâ”€â”€ Lab4.sql
â”‚   â”œâ”€â”€ Lab5.sql
â”‚   â”œâ”€â”€ process_images.py
â”‚   â””â”€â”€ spyder.py
â”œâ”€â”€ security.py
â”œâ”€â”€ static
â”‚   â”œâ”€â”€ css
â”‚   â”œâ”€â”€ items
â”‚   â”‚   â”œâ”€â”€ character
â”‚   â”‚   â”œâ”€â”€ decorations
â”‚   â”‚   â”œâ”€â”€ misc
â”‚   â”‚   â””â”€â”€ weapon
â”‚   â””â”€â”€ js
â”œâ”€â”€ templates
â”‚   â”œâ”€â”€ base.html
â”‚   â”œâ”€â”€ dashboard.html
â”‚   â”œâ”€â”€ history.html
â”‚   â”œâ”€â”€ index.html
â”‚   â”œâ”€â”€ login.html
â”‚   â”œâ”€â”€ register.html
â”‚   â””â”€â”€ wish.html
â”œâ”€â”€ pyproject.toml
â”œâ”€â”€ uv.lock
â”œâ”€â”€ LICENSE
â”œâ”€â”€ è¯¾ç¨‹è®¾è®¡æ–‡æ¡£.md
â””â”€â”€ åŽŸç¥žæŠ½å¡ç³»ç»Ÿ - æ•°æ®åº“è¯¾ç¨‹è®¾è®¡æ–‡æ¡£.md
```

## ðŸ—„ï¸ æ•°æ®åº“è®¾è®¡

### è¡¨ç»“æž„è®¾è®¡

#### 1. users - ç”¨æˆ·è¡¨
```sql
CREATE TABLE users (
    Uno                     BIGINT          PRIMARY KEY COMMENT "ç”¨æˆ·å·",
    Uname                   VARCHAR(20)     NOT NULL    COMMENT "ç”¨æˆ·å",
    Upassword               VARCHAR(64)     NOT NULL    COMMENT "å¯†ç ï¼ˆMD5ï¼‰",
    character_4star_pity    INT DEFAULT 0               COMMENT "è§’è‰²å¡æ± 4æ˜Ÿä¿åº•è®¡æ•°",
    weapon_4star_pity       INT DEFAULT 0               COMMENT "æ­¦å™¨å¡æ± 4æ˜Ÿä¿åº•è®¡æ•°",
    character_5star_pity    INT DEFAULT 0               COMMENT "è§’è‰²å¡æ± 5æ˜Ÿä¿åº•è®¡æ•°",
    weapon_5star_pity       INT DEFAULT 0               COMMENT "æ­¦å™¨å¡æ± 5æ˜Ÿä¿åº•è®¡æ•°",
    INDEX idx_uname (Uname)
);
```

#### 2. characters - è§’è‰²è¡¨
```sql
CREATE TABLE characters (
    Cno     BIGINT      PRIMARY KEY COMMENT "è§’è‰²å·",
    Cname   VARCHAR(20) NOT NULL    COMMENT "è§’è‰²å", 
    Grade   SMALLINT    NOT NULL    COMMENT "ç­‰çº§",
    INDEX idx_cname (Cname),
    INDEX idx_grade (Grade)
);
```

#### 3. weapons - æ­¦å™¨è¡¨
```sql
CREATE TABLE weapons (
    Wno     BIGINT      PRIMARY KEY COMMENT "æ­¦å™¨å·",
    Wname   VARCHAR(20) NOT NULL    COMMENT "æ­¦å™¨å",
    Grade   SMALLINT    NOT NULL    COMMENT "ç­‰çº§",
    INDEX idx_wname (Wname),
    INDEX idx_grade (Grade)
);
```

#### 4. wishes - æŠ½å¡è®°å½•è¡¨
```sql
CREATE TABLE wishes (
    Wno         BIGINT      PRIMARY KEY COMMENT "è®°å½•å·",
    Wuser       BIGINT      NOT NULL    COMMENT "ç”¨æˆ·å·",
    Wtype       TINYINT     NOT NULL    COMMENT "ç±»åž‹(0:è§’è‰²,1:æ­¦å™¨)",
    Wcharacter  BIGINT                  COMMENT "è§’è‰²å·",
    Wweapon     BIGINT                  COMMENT "æ­¦å™¨å·",
    Wtime       DATETIME    NOT NULL    COMMENT "æŠ½å¡æ—¶é—´",
    INDEX idx_wuser (Wuser),
    INDEX idx_wtime (Wtime),
    FOREIGN KEY (Wuser) REFERENCES users(Uno),
    FOREIGN KEY (Wcharacter) REFERENCES characters(Cno),
    FOREIGN KEY (Wweapon) REFERENCES weapons(Wno)
);
```

### æ•°æ®ç»Ÿè®¡
- **è§’è‰²æ•°é‡**ï¼š97ä¸ªï¼ˆåˆ é™¤æ—…è¡Œè€…åŽï¼‰
- **æ­¦å™¨æ•°é‡**ï¼š201ä¸ª
- **æ˜Ÿçº§åˆ†å¸ƒ**ï¼š1-5æ˜Ÿå®Œæ•´è¦†ç›–
- **ç”¨æˆ·æ”¯æŒ**ï¼šæ— é™åˆ¶ç”¨æˆ·æ³¨å†Œ

## ðŸš€ å®‰è£…å’Œè¿è¡Œ

### 1. çŽ¯å¢ƒå‡†å¤‡
```bash
# ç¡®ä¿å·²å®‰è£…Python 3.13+å’ŒMySQL 8.0+
# å…‹éš†é¡¹ç›®
git clone https://github.com/Cuber-Wei/NUAA-Database-design.git
cd NUAA-Database-design
```

### 2. å®‰è£…ä¾èµ–
```bash
# ä½¿ç”¨uvï¼ˆæŽ¨èï¼‰
uv sync

# æˆ–ä½¿ç”¨pip
pip install flask pymysql requests beautifulsoup4
```

### 3. æ•°æ®åº“é…ç½®
```bash
# 1. ç™»å½•MySQL
mysql -u root -p

# 2. æ‰§è¡Œå»ºè¡¨è„šæœ¬
source db.sql

# 3. å¯¼å…¥è§’è‰²å’Œæ­¦å™¨æ•°æ®ï¼ˆå¯é€‰ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å¤„ç†ï¼‰
```

### 4. ä¿®æ”¹æ•°æ®åº“é…ç½®
ç¼–è¾‘ `app.py` æ–‡ä»¶ä¸­çš„æ•°æ®åº“é…ç½®ï¼š
```python
DB_CONFIG = {
    'host': 'localhost',
    'user': 'root',
    'password': 'your_password',  # ä¿®æ”¹ä¸ºä½ çš„MySQLå¯†ç 
    'database': 'wishes_db',
    'charset': 'utf8mb4',
    'cursorclass': pymysql.cursors.DictCursor
}
```

### 5. è¿è¡Œåº”ç”¨
```bash
python app.py
```

åº”ç”¨å°†åœ¨ http://localhost:5001 å¯åŠ¨

## ðŸ“– ä½¿ç”¨è¯´æ˜Ž

### ç”¨æˆ·æ³¨å†Œå’Œç™»å½•
1. è®¿é—®ä¸»é¡µ http://localhost:5000
2. ç‚¹å‡»"ç«‹å³æ³¨å†Œ"åˆ›å»ºæ–°è´¦å·
3. å¡«å†™ç”¨æˆ·åå’Œå¯†ç å®Œæˆæ³¨å†Œ
4. ä½¿ç”¨æ³¨å†Œçš„è´¦å·ç™»å½•ç³»ç»Ÿ

### æŠ½å¡åŠŸèƒ½
1. ç™»å½•åŽè‡ªåŠ¨è·³è½¬åˆ°ä»ªè¡¨æ¿
2. ç‚¹å‡»"ç«‹å³æŠ½å¡"è¿›å…¥æŠ½å¡é¡µé¢
3. é€‰æ‹©å¡æ± ç±»åž‹ï¼ˆè§’è‰²å¡æ± /æ­¦å™¨å¡æ± ï¼‰
4. æŸ¥çœ‹å½“å‰ä¿åº•è¿›åº¦
5. é€‰æ‹©æŠ½å¡æ–¹å¼ï¼ˆå•æŠ½/åè¿žæŠ½ï¼‰
6. æŸ¥çœ‹ç²¾ç¾Žçš„æŠ½å¡ç»“æžœå±•ç¤º

### è®°å½•æŸ¥çœ‹
1. åœ¨ä»ªè¡¨æ¿æŸ¥çœ‹æœ€è¿‘10æ¡æŠ½å¡è®°å½•
2. ç‚¹å‡»"æŸ¥çœ‹å®Œæ•´è®°å½•"æµè§ˆæ‰€æœ‰åŽ†å²
3. æ”¯æŒåˆ†é¡µæµè§ˆå’Œæ—¶é—´æŽ’åº
4. è¯¦ç»†çš„é“å…·ä¿¡æ¯å’ŒèŽ·å–æ—¶é—´

## ðŸŽ¯ æ ¸å¿ƒç®—æ³•

### æŠ½å¡æ¦‚çŽ‡ç®—æ³•
```python
def calculate_wish_result(current_4star_pity, current_5star_pity):
    # ä¿åº•æœºåˆ¶ä¼˜å…ˆ
    if current_5star_pity >= 80:
        return 5  # å¼ºåˆ¶5æ˜Ÿ
    elif current_4star_pity >= 10:
        return 4  # å¼ºåˆ¶4æ˜Ÿ
    
    # æ­£å¸¸æ¦‚çŽ‡
    rand = random.random()
    if rand < 0.006:    # 0.6%
        return 5
    elif rand < 0.057:  # 5.1%
        return 4
    else:               # 94.3%
        return 3
```

### å¡æ± é€»è¾‘
- **è§’è‰²å¡æ± **ï¼š5æ˜Ÿå¿…å‡ºè§’è‰²ï¼Œ4æ˜Ÿ70%è§’è‰²30%æ­¦å™¨ï¼Œ3æ˜Ÿå‡ºæ­¦å™¨
- **æ­¦å™¨å¡æ± **ï¼šæ‰€æœ‰æ˜Ÿçº§éƒ½åªå‡ºæ­¦å™¨
- **ä¿åº•ç‹¬ç«‹**ï¼šä¸¤ä¸ªå¡æ± çš„ä¿åº•è®¡æ•°å®Œå…¨ç‹¬ç«‹

## ðŸ”§ é«˜çº§ç‰¹æ€§

### 1. ä¿åº•ç³»ç»Ÿ
- å®žæ—¶ä¿åº•è®¡æ•°æ˜¾ç¤º
- é¢œè‰²é¢„è­¦ï¼ˆæŽ¥è¿‘ä¿åº•æ—¶å˜çº¢ï¼‰
- ç‹¬ç«‹çš„4æ˜Ÿå’Œ5æ˜Ÿä¿åº•æœºåˆ¶
- è·¨å¡æ± ç‹¬ç«‹è®¡ç®—

### 2. æ•°æ®ç®¡ç†
- è‡ªåŠ¨æ•°æ®å¯¼å…¥å’Œæ›´æ–°
- å®Œæ•´çš„æŠ½å¡è®°å½•è¿½è¸ª
- é«˜æ•ˆçš„æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–
- æ”¯æŒå¤§é‡åŽ†å²æ•°æ®

### 3. ç”¨æˆ·ä½“éªŒ
- æµç•…çš„æŠ½å¡åŠ¨ç”»
- å“åº”å¼è®¾è®¡é€‚é…
- ç›´è§‚çš„æ“ä½œç•Œé¢
- è¯¦ç»†çš„å¸®åŠ©è¯´æ˜Ž

## ðŸŽ¨ ç•Œé¢å±•ç¤º

### ä¸»è¦é¡µé¢
- **ä¸»é¡µ**ï¼šæ¬¢è¿Žé¡µé¢ï¼Œç™»å½•æ³¨å†Œå…¥å£
- **ä»ªè¡¨æ¿**ï¼šç”¨æˆ·æ¦‚è§ˆï¼Œæœ€è¿‘æŠ½å¡è®°å½•
- **æŠ½å¡é¡µé¢**ï¼šæ ¸å¿ƒåŠŸèƒ½ï¼Œæ”¯æŒå®žæ—¶æŠ½å¡
- **åŽ†å²è®°å½•**ï¼šå®Œæ•´çš„æŠ½å¡åŽ†å²æµè§ˆ

### è®¾è®¡ç‰¹è‰²
- åŽŸç¥žä¸»é¢˜é…è‰²æ–¹æ¡ˆ
- æ˜Ÿçº§ä¸“å±žé¢œè‰²ç³»ç»Ÿ
- çŽ°ä»£åŒ–å¡ç‰‡å¼å¸ƒå±€
- ç²¾ç¾Žçš„åŠ¨ç”»æ•ˆæžœ

## ðŸ”® æ‰©å±•å»ºè®®

### åŠŸèƒ½æ‰©å±•
1. **ç”¨æˆ·ç³»ç»Ÿå¢žå¼º**
   - é‚®ç®±éªŒè¯æ³¨å†Œ
   - å¿˜è®°å¯†ç åŠŸèƒ½
   - ç”¨æˆ·å¤´åƒä¸Šä¼ 
   - ä¸ªäººèµ„æ–™ç®¡ç†

2. **æŠ½å¡ç³»ç»Ÿä¼˜åŒ–**
   - UPè§’è‰²/æ­¦å™¨æœºåˆ¶
   - å®šè½¨ç³»ç»Ÿå®žçŽ°
   - æŠ½å¡åŠ¨ç”»å¢žå¼º
   - éŸ³æ•ˆæ”¯æŒ

3. **æ•°æ®åˆ†æž**
   - ç”¨æˆ·æŠ½å¡ç»Ÿè®¡æŠ¥å‘Š
   - æ¦‚çŽ‡åˆ†æžå›¾è¡¨
   - æ•°æ®å¯¼å‡ºåŠŸèƒ½
   - ç®¡ç†å‘˜åŽå°

### æŠ€æœ¯ä¼˜åŒ–
1. **æ€§èƒ½æå‡**
   - æ•°æ®åº“è¿žæŽ¥æ± 
   - ç¼“å­˜æœºåˆ¶
   - å¼‚æ­¥å¤„ç†
   - CDNåŠ é€Ÿ

2. **å®‰å…¨åŠ å¼º**
   - HTTPSæ”¯æŒ
   - CSRFé˜²æŠ¤
   - è¾“å…¥éªŒè¯å¢žå¼º
   - æ—¥å¿—å®¡è®¡

## ðŸ“Š é¡¹ç›®ç»Ÿè®¡

- **ä»£ç è¡Œæ•°**ï¼šçº¦1500è¡Œ
- **å¼€å‘å‘¨æœŸ**ï¼šå®Œæ•´çš„æ•°æ®åº“è¯¾ç¨‹è®¾è®¡é¡¹ç›®
- **æµ‹è¯•è¦†ç›–**ï¼šæ ¸å¿ƒåŠŸèƒ½å…¨é¢æµ‹è¯•
- **æ–‡æ¡£å®Œæ•´åº¦**ï¼šè¯¦ç»†çš„æŠ€æœ¯æ–‡æ¡£å’Œä½¿ç”¨è¯´æ˜Ž

## ðŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨MITè®¸å¯è¯ï¼Œä»…ä¾›å­¦ä¹ å’Œç ”ç©¶ä½¿ç”¨ã€‚

---

**é¡¹ç›®åœ°å€**: [https://github.com/Cuber-Wei/NUAA-Database-design](https://github.com/Cuber-Wei/NUAA-Database-design)

**åœ¨çº¿æ¼”ç¤º**: [https://dbdesign.l0v3ch4n.top](https://dbdesign.l0v3ch4n.top)